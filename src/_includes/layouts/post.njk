---
layout: layouts/base.njk
---
<article class="post">
  <header>
    <p class="post-date">{{ date | date("%B %d, %Y") }}</p>
    <h1>{{ title }}</h1>
    <div class="post-summary-row">
      {% if summary %}<p class="post-summary">{{ summary }}</p>{% endif %}
      <button class="share-button" type="button" data-share-button aria-label="Copy link" title="Copy link">
        <svg viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false">
          <path d="M4 12v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7" />
          <path d="M16 6l-4-4-4 4" />
          <path d="M12 2v14" />
        </svg>
      </button>
    </div>
    <span class="share-feedback" role="status" aria-live="polite" aria-atomic="true" data-share-feedback></span>
  </header>
  <div class="post-body">
    {{ content | safe }}
  </div>
</article>
<script>
  (() => {
    const button = document.querySelector("[data-share-button]");
    if (!button) return;

    const feedback = document.querySelector("[data-share-feedback]");
    let timeoutId;

    const setFeedback = (message) => {
      if (!feedback) return;
      feedback.textContent = message;
      if (!message) return;
      clearTimeout(timeoutId);
      timeoutId = window.setTimeout(() => {
        feedback.textContent = "";
      }, 2000);
    };

    const fallbackCopy = (text) => {
      const field = document.createElement("textarea");
      field.value = text;
      field.setAttribute("readonly", "");
      field.style.position = "fixed";
      field.style.top = "-9999px";
      field.style.left = "-9999px";
      document.body.appendChild(field);
      field.select();
      const ok = document.execCommand("copy");
      document.body.removeChild(field);
      return ok;
    };

    button.addEventListener("click", async () => {
      const url = window.location.href;
      try {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(url);
          setFeedback("Link copied to clipboard");
          return;
        }
        if (fallbackCopy(url)) {
          setFeedback("Link copied to clipboard");
        }
      } catch (err) {
        // Ignore clipboard errors silently for speed.
      }
    });
  })();
</script>
